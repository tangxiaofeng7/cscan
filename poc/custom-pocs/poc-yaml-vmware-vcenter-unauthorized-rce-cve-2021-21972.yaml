id: poc-yaml-vmware-vcenter-unauthorized-rce-cve-2021-21972

info:
  name: poc-yaml-vmware-vcenter-unauthorized-rce-cve-2021-21972
  author: B1anda0(https://github.com/B1anda0)
  severity: critical
  tags: xray-converted,rce,unauth,cve-2021-21972,ct-149271
  reference:
    - https://swarm.ptsecurity.com/unauth-rce-vmware/

http:
  - raw:
      - |
        GET /ui/vropspluginui/rest/services/uploadova HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 405
      - type: word
        part: body
        words:
          - "Method Not Allowed"
  - raw:
      - |
        GET /ui/vropspluginui/rest/services/getstatus HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "States"
          - "Install Progress"